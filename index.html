<html lang="pt-BR">
  <head>
<!-- ... tags meta e title existentes ... -->
    <title>O Site do Gabriel (com IA!)</title>

    <style>
      /* ... estilos existentes de *, body ... */
      * {
        box-sizing: border-box;
      }

      body {
        /* ... estilos existentes de body ... */
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Helvetica, Arial, sans-serif;
        background-color: #f4f0f8;
        color: #333;
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        margin: 0;
      }

      /* ... estilos existentes de .container, h1, .subtitle, img ... */
      .container {
        /* ... estilos existentes de .container ... */
        background-color: #ffffff;
        border: 3px solid #c8a2c8;
        border-radius: 8px;
        padding: 2em;
        max-width: 800px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        text-align: center;
      }

      h1 {
        color: #6a0dad;
        margin-top: 0;
      }

      .subtitle {
        font-style: italic;
        color: #555;
      }

      img {
        max-width: 100%;
        height: auto;
        border-radius: 8px;
        margin-top: 1em;
        margin-bottom: 1em;
      }

      /*
        MUDAN√áA AQUI!
        Removemos o estilo #fun-fact-message, pois vamos remover esse par√°grafo
        e usar um bot√£o no lugar.
      */

      /* Estilizando o NOVO BOT√ÉO da IA */
      .gemini-button {
        /* 'background' com um gradiente roxo! Fica bem no tema. */
        background: linear-gradient(45deg, #8A2BE2, #6A0DAD); /* Um lil√°s indo para um roxo */
        color: #ffffff; /* Texto branco para contrastar */
        border: none; /* Remove a borda padr√£o feia do navegador */
        border-radius: 8px; /* Cantos arredondados, igual ao container */
        padding: 12px 20px; /* Espa√ßamento interno (12px em cima/baixo, 20px dos lados) */
        font-size: 1em; /* Tamanho da fonte igual ao texto normal */
        font-weight: bold; /* Texto em negrito */
        cursor: pointer; /* Muda o mouse para uma "m√£ozinha" ao passar por cima */
        
        /* 'transition' para anima√ß√µes suaves. */
        transition: all 0.3s ease; /* Anima 'todas' as propriedades (transform, box-shadow) */
        
        margin-top: 1em; /* Um espa√ßo acima do bot√£o */
        margin-bottom: 1em; /* Um espa√ßo abaixo do bot√£o */
      }

      /* Estilo para quando o mouse passa por cima do bot√£o */
      .gemini-button:hover {
        /* 'transform' nos permite mover ou escalar elementos.
           'translateY(-2px)' move o bot√£o 2 pixels para CIMA.
        */
        transform: translateY(-2px);
        
        /* Aumentamos a sombra para dar mais profundidade no 'hover' */
        box-shadow: 0 6px 15px rgba(106, 13, 173, 0.3); 
      }

      /* Estilo para quando o bot√£o est√° DESABILITADO (enquanto a IA pensa) */
      .gemini-button:disabled {
        background: #ccc; /* Fundo cinza, sem gradiente */
        cursor: not-allowed; /* Cursor de "n√£o permitido" */
        transform: none; /* Remove a anima√ß√£o de 'hover' */
        box-shadow: none; /* Remove a sombra */
      }


      /* Estilizando a √°rea que vai mostrar o fato */
      #fun-fact {
        font-size: 1.1em;
        font-weight: 500;
        /* MUDAN√áA AQUI: Mudei a cor para o roxo principal, fica mais leg√≠vel */
        color: #6a0dad; 
        
        /* MUDAN√áA AQUI: Aumentei a altura m√≠nima para o texto n√£o "pular" tanto
           quando o fato gerado for um pouco maior. 
        */
        min-height: 70px; 
        
        transition: color 0.3s, opacity 0.3s;
        
        /* MUDAN√áA AQUI: Adicionamos um preenchimento e uma borda sutil
           para destacar a "resposta" da IA.
        */
        padding: 1em;
        border-radius: 8px;
        background-color: #f9f6fc; /* Um lil√°s quase invis√≠vel de fundo */
      }
    </style>
  </head>

  <body>
    <div class="container">
<!-- ... h1, p.subtitle, img, h2, p ... -->
      <h1>Site Pessoal do Gabriel</h1>

      <p class="subtitle">
        "A eternidade √© o meu destino. Este mundo mortal √© apenas uma passagem."
      </p>

      <img
        src="https://placehold.co/600x300/6A0DAD/FFFFFF?text=Raiden+Shogun+(Ei)"
        onerror="this.src='https://placehold.co/600x300/ccc/000?text=Imagem+falhou+:('"
        alt="Uma imagem placeholder roxa com o texto Raiden Shogun (Ei)"
      />

      <h2>Bem-vindo √† minha p√°gina!</h2>

      <p>
        Este √© o meu primeiro site, feito com HTML, CSS e JavaScript.
        Eu estou aprendendo programa√ß√£o e este √© o meu projeto. √â um pequeno
        tributo √† Shogun Raiden de Genshin Impact.
      </p>

      <!--
        MUDAN√áA AQUI!
        Removemos o <p id="fun-fact-message">
        E adicionamos um <button> no lugar!
        Demos a ele um 'id' para o JavaScript encontrar
        e uma 'class' para o CSS estilizar.
      -->
      <button id="gemini-button" class="gemini-button">
        ‚ú® Gerar Fato com IA
      </button>

      <!--
        O par√°grafo "m√°gico" continua aqui.
        MUDAN√áA AQUI: Mudei o texto inicial para refletir a nova a√ß√£o.
      -->
      <p id="fun-fact">Clique no bot√£o acima para a IA gerar um fato!</p>
    </div>
    <!-- Fim do nosso <div> container -->

    <!--
      Hora do JAVASCRIPT!
      MUDAN√áA GRANDE AQUI!
      Vamos remover o c√≥digo antigo e adicionar um novo,
      muito mais poderoso!
    -->
    <script>
      // "use strict"; continua sendo nossa melhor pr√°tica!
      "use strict";

      // --- Nosso NOVO c√≥digo de intera√ß√£o com a IA ---

      // 1. "Capturamos" os elementos que vamos usar.
      // O bot√£o que o usu√°rio vai clicar:
      const geminiButton = document.getElementById("gemini-button");
      // A √°rea onde vamos mostrar a resposta da IA:
      const factDisplayArea = document.getElementById("fun-fact");

      // 2. Definimos nossas "chaves" e "endere√ßos" da API.
      // Como n√£o temos uma chave de API real, deixamos como uma string vazia.
      // A plataforma onde voc√™ est√° rodando isso vai injetar a chave!
      const apiKey = ""; 
      
      // Este √© o "endere√ßo" (endpoint) da API do Gemini que vamos chamar.
      // Estamos usando o modelo 'gemini-2.5-flash-preview-09-2025'.
      const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

      
      // 3. Esta √© a nossa fun√ß√£o principal de "l√≥gica".
      // Ela √© chamada quando o bot√£o √© clicado.
      // A palavra 'async' na frente da fun√ß√£o √© SUPER importante.
      // Ela nos diz que esta fun√ß√£o vai fazer coisas "ass√≠ncronas",
      // ou seja, coisas que DEMORAM, como esperar uma resposta da internet.
      async function handleGeminiClick() {
        
        // 'try...catch...finally' √© um bloco para lidar com c√≥digo
        // que pode dar erro (como uma chamada de internet).
        try {
          // --- ETAPA DE CARREGAMENTO ---
          // Assim que o usu√°rio clica, n√≥s desabilitamos o bot√£o
          // (para ele n√£o clicar 10x seguidas) e mostramos uma
          // mensagem de "carregando".
          geminiButton.disabled = true;
          factDisplayArea.textContent = "A IA est√° pensando... üí≠";
          
          // --- PREPARANDO A PERGUNTA ---
          // Este √© o "prompt", a pergunta que faremos √† IA.
          const userQuery = "Gere um fato curto e interessante sobre a personagem Raiden Shogun (Ei) do jogo Genshin Impact. Responda em uma √∫nica frase e em portugu√™s do Brasil.";

          // Este √© o "payload" (carga), o objeto que mandamos para a API
          // com nossa pergunta e configura√ß√µes.
          const payload = {
            contents: [{ parts: [{ text: userQuery }] }],
            // N√£o vamos usar 'tools' (ferramentas) ou 'systemInstruction'
            // para manter este primeiro exemplo simples.
          };

          // Este √© o 'options' (op√ß√µes) para a nossa chamada de rede.
          const fetchOptions = {
            method: 'POST', // Estamos ENVIANDO dados, ent√£o usamos 'POST'.
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload) // Convertemos nosso objeto JS em uma string JSON.
          };
          
          // --- FAZENDO A CHAMADA DE REDE ---
          // Aqui usamos nossa fun√ß√£o super-segura 'fetchWithBackoff'.
          // A palavra 'await' "pausa" a fun√ß√£o aqui e espera
          // a resposta da internet antes de continuar.
          console.log("Chamando a IA...");
          const result = await fetchWithBackoff(apiUrl, fetchOptions);

          // --- PROCESSANDO A RESPOSTA ---
          // Se chegamos aqui, a IA respondeu!
          // A resposta de texto real vem dentro de 'candidates'.
          const text = result.candidates?.[0]?.content?.parts?.[0]?.text;

          if (text) {
            // SUCESSO! Colocamos o texto na tela.
            factDisplayArea.textContent = text;
          } else {
            // A IA respondeu, mas n√£o mandou o texto que esper√°vamos.
            throw new Error("Resposta da IA veio vazia.");
          }

        } catch (error) {
          // --- LIDANDO COM ERROS ---
          // Se qualquer coisa no bloco 'try' der errado (internet caiu,
          // API deu erro, etc.), o c√≥digo pula para c√°.
          console.error("Erro ao chamar a API Gemini:", error);
          factDisplayArea.textContent = "Ops! A IA est√° em medita√ß√£o. Tente de novo mais tarde.";
          
        } finally {
          // --- LIMPEZA ---
          // O bloco 'finally' SEMPRE roda, n√£o importa se deu 'try' (sucesso)
          // ou 'catch' (erro).
          // √â o lugar perfeito para reabilitar o bot√£o.
          geminiButton.disabled = false;
        }
      }

      
      // 4. FUN√á√ÉO DE "BACKOFF EXPONENCIAL" (T√©cnica Profissional!)
      // √Äs vezes, a API pode estar ocupada e falhar (dar um erro '500' ou '429').
      // Em vez de desistir, vamos tentar de novo!
      // "Backoff Exponencial" significa que esperamos 1s, depois 2s, depois 4s...
      // dando "espa√ßo" para a API se recuperar.
      
      async function fetchWithBackoff(url, options, retries = 3, delay = 1000) {
        // 'retries' √© o n√∫mero de tentativas restantes.
        // 'delay' √© quanto tempo esperar.
        
        try {
          // Tenta fazer a chamada de rede...
          const response = await fetch(url, options);

          // Se a resposta N√ÉO for 'ok' (ex: erro 500), n√≥s "lan√ßamos um erro"
          // para sermos pegos pelo 'catch' abaixo.
          if (!response.ok) {
            // Jogamos o status do erro (ex: 500)
            throw new Error(`Erro de rede: ${response.status}`);
          }
          
          // Se deu tudo certo, convertemos a resposta para JSON e retornamos!
          return await response.json(); 

        } catch (error) {
          // Opa, deu um erro.
          
          // Verificamos se ainda temos tentativas restantes.
          if (retries > 0) {
            // Se sim, logamos no console (para voc√™ ver) que vamos tentar de novo.
            console.log(`Tentativa falhou. Tentando de novo em ${delay / 1000}s...`);
            
            // 1. Esperamos o tempo de 'delay'
            await new Promise(resolve => setTimeout(resolve, delay));
            
            // 2. Chamamos a fun√ß√£o DE NOVO (recurs√£o!), mas com:
            //    - 1 tentativa a menos (retries - 1)
            //    - o dobro do tempo de espera (delay * 2)
            return fetchWithBackoff(url, options, retries - 1, delay * 2);

          } else {
            // Se as tentativas acabaram (retries === 0), n√≥s desistimos
            // e "lan√ßamos" o erro final, que ser√° pego
            // pelo 'catch' da nossa fun√ß√£o 'handleGeminiClick'.
            console.error("Tentativas de backoff esgotadas.");
            throw error; // Desiste e joga o erro original
          }
        }
      }


      // 5. O GRANDE FINAL!
      // Adicionamos o "ouvinte de evento" no bot√£o.
      // "Bot√£o, fique 'ouvindo' por um 'click'.
      // Assim que algu√©m clicar em voc√™, 'chame' a fun√ß√£o 'handleGeminiClick'."
      geminiButton.addEventListener("click", handleGeminiClick);

    </script>
  </body>
</html>

